# テストデータ説明

このディレクトリには、RAW-JPEG Matcher Toolのテスト用実際のサンプルファイルが含まれています。これらのファイルは、ツールの各機能を包括的にテストするために慎重に選択・構成されています。

## ファイル構成

### 一致するペア（同じベース名と撮影日時）

#### 1. **test001.JPG** ↔ **test001.CR3**
- **ベース名**: test001
- **RAW形式**: Canon CR3（大文字拡張子）
- **JPEG形式**: JPEG（大文字拡張子）
- **撮影日時**: 同一（Exif DateTimeOriginalで確認可能）
- **期待結果**: マッチする（ファイル名+日時マッチング）
- **テスト目的**: 
  - 基本的なマッチング機能
  - Canon CR3形式のサポート
  - 大文字拡張子の処理

#### 2. **test002.jpg** ↔ **test002.cr3**
- **ベース名**: test002
- **RAW形式**: Canon CR3（小文字拡張子）
- **JPEG形式**: JPEG（小文字拡張子）
- **撮影日時**: 同一（Exif DateTimeOriginalで確認可能）
- **期待結果**: マッチする（ファイル名+日時マッチング）
- **テスト目的**:
  - 大文字小文字を区別しない比較
  - 小文字拡張子の処理
  - クロスプラットフォーム互換性

### 一致しないペア

#### 3. **test003.JPG**
- **ベース名**: test003
- **対応するRAWファイル**: なし
- **期待結果**: マッチするRAWファイルなし
- **テスト目的**:
  - マッチしないファイルの適切な処理
  - エラーハンドリングの確認
  - 処理継続の確認

### 同じベース名だが異なる撮影日時

#### 4. **test004.JPG** ↔ **test004.CR3**
- **ベース名**: test004（同じ）
- **撮影日時**: 異なる（意図的に変更済み）
- **期待結果**: マッチしない（撮影日時が異なるため）
- **テスト目的**:
  - 厳密な日時マッチングの確認
  - ファイル名のみでは不十分であることの確認
  - 誤マッチの防止

## テストケースと要件の対応

これらのファイルは以下の要件をテストするために使用されます：

### 機能要件
- **要件 2.1**: ベースファイル名の抽出（拡張子除去）
- **要件 2.2**: ベースファイル名の完全一致
- **要件 2.3**: 大文字小文字を区別しない比較
- **要件 3.1**: JPEGファイルからのExif撮影日時抽出
- **要件 3.2**: RAWファイルからのExif撮影日時抽出
- **要件 3.3**: 撮影日時の完全一致による検証
- **要件 3.5**: Canon CR3形式のサポート
- **要件 8.1**: マッチしないファイルの適切な処理

### 正確性プロパティ
- **プロパティ3**: ベース名抽出の一貫性
- **プロパティ4**: Exif日時抽出
- **プロパティ5**: 日時マッチングの厳密性

## ファイル詳細情報

### ファイルサイズ
- **test001.JPG**: 約 2.1MB
- **test001.CR3**: 約 24.5MB
- **test002.jpg**: 約 1.8MB
- **test002.cr3**: 約 22.3MB
- **test003.JPG**: 約 1.9MB
- **test004.JPG**: 約 2.0MB
- **test004.CR3**: 約 23.1MB

### Exif情報
すべてのファイルには以下のExif情報が含まれています：
- **DateTimeOriginal**: 撮影日時（最優先）
- **CreateDate**: 作成日時
- **ModifyDate**: 更新日時
- **Camera Make**: Canon
- **Camera Model**: Canon EOS R5（例）

### ファイル形式詳細
- **JPEG**: 標準的なJPEG形式、sRGB色空間
- **CR3**: Canon RAW Version 3、14-bit RAWデータ

## 使用方法

### 統合テストでの使用
```bash
# 統合テストの実行
pytest tests/test_integration.py -v

# 特定のテストケースのみ実行
pytest tests/test_integration.py::test_matching_pairs -v
```

### 手動テストでの使用
```bash
# インデックス作成
raw-jpeg-matcher index tests/data

# マッチングテスト
raw-jpeg-matcher match tests/data --verbose
```

### プロパティベーステストでの使用
```bash
# プロパティテストの実行
pytest tests/test_*_properties.py -v
```

## 期待される結果

### マッチング結果
1. **test001.JPG** → **test001.CR3** ✅ マッチ（ファイル名+日時）
2. **test002.jpg** → **test002.cr3** ✅ マッチ（ファイル名+日時）
3. **test003.JPG** → なし ❌ マッチなし
4. **test004.JPG** → **test004.CR3** ❌ マッチなし（日時不一致）

### 処理統計
- **総JPEGファイル数**: 4
- **総RAWファイル数**: 3
- **マッチ数**: 2
- **コピー成功**: 2（test001, test002）
- **マッチなし**: 2（test003, test004）

## 注意事項

### ファイルの取り扱い
- これらは実際のCanon RAWファイル（CR3形式）とJPEGファイルです
- 実際のExif情報が含まれているため、ExifReaderによる撮影日時の読み取りテストが可能です
- ファイルサイズが大きいため、Gitリポジトリのサイズに注意してください

### テスト環境
- ExifToolがインストールされている環境でのみ正常に動作します
- macOS、Windows、Linuxすべてでテスト可能です
- Python 3.10以上が必要です

### カスタマイズ
- 新しいテストケースを追加する場合は、このREADMEも更新してください
- 異なるカメラメーカーのRAWファイルを追加する場合は、対応する説明を追加してください
- テストデータを変更する場合は、関連するテストケースも更新してください

## トラブルシューティング

### よくある問題
1. **ExifTool not found**: ExifToolがインストールされていることを確認
2. **Permission denied**: ファイルの読み取り権限を確認
3. **File not found**: テストデータファイルが存在することを確認

### デバッグ情報
詳細なデバッグ情報は以下のコマンドで取得できます：
```bash
# 詳細ログ付きでテスト実行
raw-jpeg-matcher match tests/data --verbose

# 個別ファイルのExif情報確認
exiftool tests/data/test001.JPG
exiftool tests/data/test001.CR3
```